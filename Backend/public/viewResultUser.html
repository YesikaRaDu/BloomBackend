<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Dec 11 2017 06:00:44 GMT+0000 (UTC)  -->
<html data-wf-page="5a2cc9187cc4250001941da8" data-wf-site="5a2cc9177cc4250001941da2">

<head>
    <meta charset="utf-8">
    <title>bloom</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Webflow" name="generator">
    <link href="css/normalize.css" rel="stylesheet" type="text/css">
    <link href="css/webflow.css" rel="stylesheet" type="text/css">
    <link href="css/bloom-ae35db.webflow.css" rel="stylesheet" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">
        WebFont.load({
            google: {
                families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic", "Roboto:300,regular", "Roboto Condensed:regular"]
            }
        });
    </script>
    <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
    <script type="text/javascript">
        ! function(o, c) {
            var n = c.documentElement,
                t = " w-mod-";
            n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch")
        }(window, document);
    </script>

    <link href="./images/bloomIcon.png" rel="shortcut icon" type="image/x-icon">
    <link href="./images/bloomIcon.png" rel="apple-touch-icon">
</head>

<body class="body">

    <div class="bgbackend2">
        <div class="headerbackend">
            <h1 class="heading-2">Resultados</h1>
        </div>
        <div id="containBotones">
            <h3 class="tituloPag" id="tituloNombre">Prueba de </h3>
            <a onclick="tablaUser()" id="resultadosBoton" class="buttonRes">Ver pruebas</a>
            <a onclick="tablaUserEntrenamiento()" id="entrenamientoBoton" class="buttonRes">Ver entrenamientos</a>

        </div>
        <div class="contentusuarios3">
            <h3>Hanoi</h3>
            <table class="order-table table styTable StandardTable" id="tablaHanoi">
            </table>
            <h3>Hanoi 2</h3>
            <table class="order-table table styTable StandardTable" id="tablaHanoi2">
            </table>
            <h3>Stroop</h3>
            <table class="order-table table styTable StandardTable" id="tablaStroop">
            </table>
            <h3>Wisconsin</h3>
            <table class="order-table table styTable StandardTable" id="tablaWisconsin">
            </table>
            <h3>Token</h3>
            <table class="order-table table styTable StandardTable" id="tablaToken">
            </table>
            <h3>Raven</h3>
            <table class="order-table table styTable StandardTable" id="tablaRaven">
            </table>
        </div>
        <div class="contentusuarios2">
            <div id="commentBox">

            </div>
            <div class="commentBox">
                <textarea style="min-width: 550px; margin-left: auto; margin-right: auto; margin-bottom: 10px;" id="comentario"></textarea>
                <input style="display: inline-flex;  padding: 5px; max-width: 550px; margin-left: auto; margin-right: auto; margin-bottom: 10px;" type="submit" value="Comentar" onclick="guardar()">
            </div>


        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>

    <script>
        var config = {
            apiKey: "AIzaSyB-CHGXqLBlKQfHmHHYVsIT-_AyBYNkFS0",
            authDomain: "bloomsabana.firebaseapp.com",
            databaseURL: "https://bloomsabana.firebaseio.com",
            projectId: "bloomsabana",
            storageBucket: "bloomsabana.appspot.com",
            messagingSenderId: "584579774141"
        };
        firebase.initializeApp(config);
        firebase.auth().onAuthStateChanged(function(user) {
            window.user = user;
            if (user) {
                firebase.database().ref("administradores").once("value").then(function(snap) {
                    snap.forEach(function(childSnap) {
                        var mail = childSnap.val().identificacion.numero + "@bloom.com";
                        if (user.email == mail) {
                            window.email = user.email;
                            if (childSnap.val().rol == "administrador") {

                                var url_string = window.location.href;
                                var url = new URL(url_string);
                                var c = url.searchParams.get("c");
                                firebase.database().ref("usuarios").once("value").then(function(snap3) {
                                    snap3.forEach(function(childSnap3) {
                                        var mail = childSnap3.val().identificacion.numero;
                                        if (c == mail) {
                                            window.key = childSnap3.key;
                                            cargar();
                                        }

                                    });
                                });
                                tablaUser();

                            } else {
                                alert("Ud no esta autorizado para modificar datos");
                                window.location.href = "backend.html";
                            }
                        }
                    });
                });

            } else {
                alert("Espere...");
                window.location.href = "index.html";
            }
        });
    </script>
    <script>
        function tablaUser() {
            clearTable();
            var url_string = window.location.href;
            var url = new URL(url_string);
            var c = url.searchParams.get("c");
            firebase.database().ref("usuarios").once("value").then(function(snap) {
                snap.forEach(function(childSnap) {
                    var mail = childSnap.val().identificacion.numero;
                    if (c == mail) {
                        $("#tituloNombre").text("Prueba de " + childSnap.val().nombre);

                        $("#tablaHanoi").append("<tr> <td>" + childSnap.val().hanoi.estado + "</td> <td>" + childSnap.val().hanoi.correctos + "</td> <td>" + childSnap.val().hanoi.errores + "</td> <td>" + childSnap.val().nivel + "</td> <td>" + childSnap.val().duracionTotal + "</td> " + "</tr>");
                        $("#tablaHanoi").append("</tbody>");

                        $("#tablaHanoi2").append("<tr> <td>" + childSnap.val().hanoi2.estado + "</td> <td>" + childSnap.val().hanoi2.correctos + "</td> <td>" + childSnap.val().hanoi2.errores + "</td> <td>" + childSnap.val().nivel + "</td> <td>" + childSnap.val().duracionTotal + "</td> " + "</tr>");
                        $("#tablaHanoi2").append("</tbody>");

                        $("#tablaStroop").append("<tr> <td>" + childSnap.val().stroop.estado + "</td> <td>" + childSnap.key.val().stroop.correctos + "</td> <td>" + childSnap.val().stroop.errores + "</td> <td>" + childSnap.val().nivel + "</td> <td>" + childSnap.val().duracionTotal + "</td> " + "</tr>");
                        $("#tablaStroop").append("</tbody>");

                        $("#tablaWisconsin").append("<tr> <td>" + childSnap.val().wisconsin.estado + "</td> <td>" + childSnap.key + "</td> <td>" + childSnap.val().nombre + "</td> <td>" + childSnap.val().nivel + "</td> <td>" + childSnap.val().fecha + "</td> <td>" + childSnap.val().fecha + "</td> <td>" + childSnap.val().duracionTotal + "</td>" + "</tr>");
                        $("#tablaWisconsin").append("</tbody>");

                        $("#tablaToken").append("<tr> <td>" + childSnap.val().token.estado + "</td> <td>" + childSnap.key + "</td> <td>" + childSnap.val().nombre + "</td> <td>" + childSnap.val().nivel + "</td> <td>" + childSnap.val().fecha + "</td> <td>" + childSnap.val().duracionTotal + "</td>" + "</tr>");
                        $("#tablaToken").append("</tbody>");

                        $("#tablaRaven").append("<tr> <td>" + childSnap.val().raven.estado + "</td> <td>" + childSnap.key + "</td> <td>" + childSnap.val().nombre + "</td> <td>" + childSnap.val().duracionTotal + "</td>" + "</tr>");
                        $("#tablaRaven").append("</tbody>");
                    }
                });
            });
        }

        function tablaUserEntrenamiento() {
            clearTable();
            var url_string = window.location.href;
            var url = new URL(url_string);
            var c = url.searchParams.get("c");
            firebase.database().ref("usuarios").once("value").then(function(snap) {
                snap.forEach(function(childSnap) {
                    var mail = childSnap.val().identificacion.numero;
                    if (c == mail) {

                        firebase.database().ref("usuarios/" + childSnap.key + "/hanoi/").once("value").then(function(snap2) {
                            snap2.forEach(function(childSnap2) {
                                if (childSnap2.key.includes("entre")) {

                                    $("#tablaHanoi").append("<tr> <td>--- </td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> " + "</tr>");
                                    $("#tablaHanoi").append("</tbody>");
                                }
                            });
                        });
                        firebase.database().ref("usuarios/" + childSnap.key + "/stroop/").once("value").then(function(snap2) {
                            snap2.forEach(function(childSnap2) {
                                if (childSnap2.key.includes("entre")) {
                                    $("#tablaStroop").append("<tr> <td>--</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> " + "</tr>");
                                    $("#tablaStroop").append("</tbody>");
                                }
                            });
                        });
                        firebase.database().ref("usuarios/" + childSnap.key + "/wisconsin/").once("value").then(function(snap2) {
                            snap2.forEach(function(childSnap2) {
                                if (childSnap2.key.includes("entre")) {

                                    $("#tablaWisconsin").append("<tr> <td>--</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td>" + "</tr>");
                                    $("#tablaWisconsin").append("</tbody>");
                                }
                            });
                        });

                        firebase.database().ref("usuarios/" + childSnap.key + "/token/").once("value").then(function(snap2) {
                            snap2.forEach(function(childSnap2) {
                                if (childSnap2.key.includes("entre")) {
                                    $("#tablaToken").append("<tr> <td>--</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td>" + "</tr>");
                                    $("#tablaToken").append("</tbody>");
                                }
                            });
                        });
                        firebase.database().ref("usuarios/" + childSnap.key + "/raven/").once("value").then(function(snap2) {
                            snap2.forEach(function(childSnap2) {
                                if (childSnap2.key.includes("entre")) {
                                    $("#tablaRaven").append("<tr> <td>--</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td> <td>" + childSnap2.key + "</td>" + "</tr>");
                                    $("#tablaRaven").append("</tbody>");
                                }
                            });
                        });
                    }
                });
            });
        }

        function clearTable() {
            $("#tablaHanoi").append("<thead> <tr> <th>Estado</th><th> No de Mov Acertados </th> <th> No de Errores </th> <th> Latencia </th> <th> Duración Total </th> </tr> </thead> <tbody>");

            $("#tablaHanoi2").append("<thead> <tr> <th>Estado</th><th> No de Mov Acertados </th> <th> No de Errores </th> <th> Latencia </th> <th> Duración Total </th> </tr> </thead> <tbody>");

            $("#tablaStroop").append("<thead> <tr> <th>Estado</th> <th> No de Aciertos </th> <th> No de Errores </th> <th> Latencia </th> <th> Duración Total </th> </tr> </thead> <tbody>");

            $("#tablaWisconsin").append("<thead> <tr> <th>Estado</th> <th> No de Aciertos </th> <th> Categorias conseguidas </th> <th> Errores Perseverativos </th> <th> Errores No Perseverativos </th> <th> Errores Mantenimiento </th> <th> Duración Total </th> </tr> </thead> <tbody>");

            $("#tablaToken").append("<thead> <tr> <th>Estado</th> <th> Aciertos Palabras </th> <th> Aciertos Colores </th> <th> Palabras-Colores </th> <th> Latencia </th> <th> Duración Total </th> </tr> </thead> <tbody>");

            $("#tablaRaven").append("<thead> <tr> <th>Estado</th> <th> Aciertos  </th> <th> Incorrectas </th> <th> Duración Total </th> </tr> </thead> <tbody>");

            while (document.getElementById('tablaHanoi').rows.length > 1) {
                document.getElementById('tablaHanoi').deleteRow(1);
            }
            while (document.getElementById('tablaHanoi2').rows.length > 1) {
                document.getElementById('tablaHanoi2').deleteRow(1);
            }

            while (document.getElementById('tablaStroop').rows.length > 1) {
                document.getElementById('tablaStroop').deleteRow(1);
            }
            while (document.getElementById('tablaWisconsin').rows.length > 1) {
                document.getElementById('tablaWisconsin').deleteRow(1);
            }
            while (document.getElementById('tablaToken').rows.length > 1) {
                document.getElementById('tablaToken').deleteRow(1);
            }
            while (document.getElementById('tablaRaven').rows.length > 1) {
                document.getElementById('tablaRaven').deleteRow(1);
            }

        }
    </script>
    <script>
        function cargar() {
            firebase.database().ref().child("usuarios/" + window.key + "/comentarios").once("value").then(function(snap2) {
                snap2.forEach(function(childSnap2) {
                    $("#commentBox").append("<div class='comment'> <h5>" + childSnap2.val().user + ":" + " </h5><p style='font-size:16px; margin-top: -8px;'>" + childSnap2.val().text + " </p></div>");
                });
            });
        }

        function guardar() {

            var text = $("#comentario").val();
            firebase.database().ref("usuarios/" + window.key + "/comentarios").push().set({
                user: window.email,
                text: text
            }).then(function() {
                $("#comentario").text("");
                $("#commentBox").append("<div class='comment'> <h5>" + window.email + ":" + " </h5><p style='font-size:16px; margin-top: -8px;'>" + text + " </p></div>");
            }).catch(function(error) {
                console.log(error);
                alert("Algo salió mal :(");
            });

        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js" type="text/javascript"></script>
    <script src="js/webflow.js" type="text/javascript"></script>
    <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>

</html>
